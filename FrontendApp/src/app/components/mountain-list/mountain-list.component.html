<div class="container-fluid py-3">
  <div class="row">
    <div class="col-12">
      <h3 class="mb-3">Lista de Monta√±as</h3>

      <!-- Filtros compactos -->
      <div class="card mb-3">
        <div class="card-body py-2">
          <div class="row g-2 align-items-end">
            <div class="col-md-2">
              <label class="form-label form-label-sm">Nombre</label>
              <input
                type="text"
                class="form-control form-control-sm"
                placeholder="Buscar..."
                [(ngModel)]="filters.name"
                name="name"
                (keyup.enter)="applyFilters()"
              />
            </div>
            <div class="col-md-2">
              <label class="form-label form-label-sm">Ubicaci√≥n</label>
              <input
                type="text"
                class="form-control form-control-sm"
                placeholder="Ubicaci√≥n..."
                [(ngModel)]="filters.location"
                name="location"
                (keyup.enter)="applyFilters()"
              />
            </div>
            <div class="col-md-2">
              <label class="form-label form-label-sm">Altura m√≠n (m)</label>
              <input
                type="number"
                class="form-control form-control-sm"
                placeholder="0"
                [(ngModel)]="filters.minHeight"
                name="minHeight"
                (keyup.enter)="applyFilters()"
              />
            </div>
            <div class="col-md-2">
              <label class="form-label form-label-sm">Altura m√°x (m)</label>
              <input
                type="number"
                class="form-control form-control-sm"
                placeholder="9000"
                [(ngModel)]="filters.maxHeight"
                name="maxHeight"
                (keyup.enter)="applyFilters()"
              />
            </div>
            <div class="col-md-1">
              <label class="form-label form-label-sm">Tama√±o</label>
              <select
                class="form-select form-select-sm"
                [(ngModel)]="pageSize"
                (change)="onPageSizeChange()"
                name="pageSize"
              >
                <option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</option>
              </select>
            </div>
            <div class="col-md-3">
              <button type="button" class="btn btn-primary btn-sm me-1" (click)="applyFilters()" [disabled]="loading">
                Filtrar
              </button>
              <button type="button" class="btn btn-outline-secondary btn-sm" (click)="clearFilters()" [disabled]="loading">
                Limpiar
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Mensaje de error -->
      <div *ngIf="error" class="alert alert-danger alert-sm">
        {{ error }}
      </div>

      <!-- Indicador de carga -->
      <div *ngIf="loading && !error" class="text-center py-3">
        <div class="spinner-border spinner-border-sm" role="status">
          <span class="visually-hidden">Cargando...</span>
        </div>
        <small class="text-muted ms-2">Cargando...</small>
      </div>

      <!-- Tabla de monta√±as -->
      <div *ngIf="!loading && !error" class="table-responsive">
        <table class="table table-hover">
          <thead class="table-dark">
            <tr>
              <th class="col-action text-center" style="width: 60px;">Detalle</th>
              <th class="col-name">Nombre</th>
              <th class="col-height text-center">Altura (m)</th>
              <th class="col-location">Ubicaci√≥n</th>
              <th class="col-date text-center">Fecha ascenso</th>
              <th class="col-status text-center">Escalada</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let m of mountains; trackBy: trackByMountain">
              <td class="text-center">
                <button
                  type="button"
                  class="btn btn-outline-primary btn-sm"
                  (click)="viewMountainDetail(m.id)"
                  title="Ver detalles">
                  <i class="bi bi-arrow-right-circle"></i>
                </button>
              </td>
              <td class="fw-semibold text-primary">{{ m.name }}</td>
              <td class="text-center">
                <span class="height-badge">{{ m.height | number:'1.0-0' }}</span>
              </td>
              <td class="text-muted">{{ m.location }}</td>
              <td class="text-center">
                <span class="date-text" *ngIf="m.ascentDate; else noDate">
                  {{ m.ascentDate | date:'dd/MM/yyyy' }}
                </span>
                <ng-template #noDate>
                  <span class="text-muted">-</span>
                </ng-template>
              </td>
              <td class="text-center">
                <span class="badge status-badge" [ngClass]="m.isClimbed ? 'bg-success' : 'bg-secondary'">
                  {{ m.isClimbed ? 'Escalada' : 'Pendiente' }}
                </span>
              </td>
            </tr>
            <tr *ngIf="mountains.length === 0">
              <td colspan="5" class="text-center text-muted py-4">
                <i class="me-2">üèîÔ∏è</i>
                <span>No se encontraron monta√±as con los filtros aplicados</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Paginaci√≥n mejorada -->
      <div *ngIf="!loading && !error && mountains.length > 0" class="d-flex justify-content-between align-items-center mt-3 p-3 bg-light rounded">
        <button
          class="btn btn-outline-primary"
          (click)="prevPage()"
          [disabled]="page === 1 || loading"
        >
          <span class="me-1">‚Üê</span> Anterior
        </button>

        <div class="pagination-info text-center">
          <strong>P√°gina {{ page }} de {{ totalPages }}</strong>
          <br>
          <small class="text-muted">{{ total }} monta√±as en total</small>
        </div>

        <button
          class="btn btn-outline-primary"
          (click)="nextPage()"
          [disabled]="page === totalPages || loading"
        >
          Siguiente <span class="ms-1">‚Üí</span>
        </button>
      </div>
    </div>
  </div>
</div>
